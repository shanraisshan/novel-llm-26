<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 900 1050" font-family="system-ui, -apple-system, sans-serif">
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#6366f1"/>
    </marker>
    <marker id="arrowhead-red" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#ef4444"/>
    </marker>
    <marker id="arrowhead-green" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#22c55e"/>
    </marker>
    <marker id="arrowhead-orange" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#f97316"/>
    </marker>
    <linearGradient id="mcpGradient" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#f97316;stop-opacity:0.3" />
      <stop offset="100%" style="stop-color:#8b5cf6;stop-opacity:0.3" />
    </linearGradient>
  </defs>

  <!-- Background -->
  <rect width="900" height="1050" fill="#0f172a"/>

  <!-- Title -->
  <text x="450" y="45" text-anchor="middle" fill="white" font-size="24" font-weight="bold">Novel LLM Research Workflow</text>
  <text x="450" y="70" text-anchor="middle" fill="#94a3b8" font-size="14">Infinite loop until consensus &lt; 10% | MCP-Enhanced Research</text>

  <!-- User Start -->
  <rect x="350" y="95" width="200" height="50" rx="25" fill="#22c55e"/>
  <text x="450" y="127" text-anchor="middle" fill="white" font-size="14" font-weight="bold">/execute-workflow</text>

  <!-- Arrow from Start -->
  <line x1="450" y1="145" x2="450" y2="175" stroke="#6366f1" stroke-width="2" marker-end="url(#arrowhead)"/>

  <!-- Step 1: Check State -->
  <rect x="300" y="180" width="300" height="60" rx="8" fill="#1e293b" stroke="#6366f1" stroke-width="2"/>
  <text x="450" y="205" text-anchor="middle" fill="#6366f1" font-size="12" font-weight="bold">STEP 1: Check State</text>
  <text x="450" y="225" text-anchor="middle" fill="white" font-size="13">Read workflow-state + questions</text>

  <!-- Decision Diamond -->
  <polygon points="450,260 530,310 450,360 370,310" fill="#1e293b" stroke="#f59e0b" stroke-width="2"/>
  <text x="450" y="305" text-anchor="middle" fill="#f59e0b" font-size="11" font-weight="bold">Pending?</text>
  <text x="450" y="320" text-anchor="middle" fill="#f59e0b" font-size="11" font-weight="bold">exists?</text>

  <!-- No branch - to Generate Question -->
  <line x1="370" y1="310" x2="200" y2="310" stroke="#ef4444" stroke-width="2"/>
  <line x1="200" y1="310" x2="200" y2="395" stroke="#ef4444" stroke-width="2" marker-end="url(#arrowhead-red)"/>
  <text x="285" y="300" fill="#ef4444" font-size="11">No</text>

  <!-- Yes branch - to Verify -->
  <line x1="530" y1="310" x2="700" y2="310" stroke="#22c55e" stroke-width="2"/>
  <line x1="700" y1="310" x2="700" y2="535" stroke="#22c55e" stroke-width="2" marker-end="url(#arrowhead-green)"/>
  <text x="600" y="300" fill="#22c55e" font-size="11">Yes</text>

  <!-- Step 2: Generate Question with MCP (left side) -->
  <rect x="50" y="400" width="300" height="140" rx="8" fill="#1e293b" stroke="#8b5cf6" stroke-width="2"/>
  <text x="200" y="425" text-anchor="middle" fill="#8b5cf6" font-size="12" font-weight="bold">STEP 2: Generate Question</text>
  <text x="200" y="447" text-anchor="middle" fill="white" font-size="12">Research + Generate via MCP</text>

  <!-- Agent box -->
  <rect x="100" y="457" width="200" height="24" rx="4" fill="#8b5cf6" opacity="0.3"/>
  <text x="200" y="474" text-anchor="middle" fill="#c4b5fd" font-size="11" font-weight="bold">1x opus-researcher</text>

  <!-- MCP Tools box -->
  <rect x="75" y="490" width="250" height="42" rx="4" fill="url(#mcpGradient)" stroke="#f97316" stroke-width="1"/>
  <text x="200" y="506" text-anchor="middle" fill="#f97316" font-size="10" font-weight="bold">MCP TOOLS</text>
  <text x="200" y="522" text-anchor="middle" fill="#fdba74" font-size="9">Tavily Web Search | Reddit MCP</text>

  <!-- Arrow from Generate to Verify -->
  <line x1="350" y1="470" x2="420" y2="470" stroke="#6366f1" stroke-width="2"/>
  <line x1="420" y1="470" x2="420" y2="540" stroke="#6366f1" stroke-width="2" marker-end="url(#arrowhead)"/>

  <!-- Step 3: Verify Question -->
  <rect x="300" y="545" width="300" height="120" rx="8" fill="#1e293b" stroke="#6366f1" stroke-width="2"/>
  <text x="450" y="570" text-anchor="middle" fill="#6366f1" font-size="12" font-weight="bold">STEP 3: Verify Question</text>
  <text x="450" y="592" text-anchor="middle" fill="white" font-size="12">Launch 5 parallel LLM answerers</text>
  <rect x="350" y="600" width="200" height="24" rx="4" fill="#3b82f6" opacity="0.3"/>
  <text x="450" y="617" text-anchor="middle" fill="#93c5fd" font-size="11" font-weight="bold">5x opus-answer (parallel)</text>
  <text x="450" y="638" text-anchor="middle" fill="#94a3b8" font-size="11">Synthesize with verifier</text>
  <rect x="365" y="643" width="170" height="18" rx="4" fill="#22c55e" opacity="0.3"/>
  <text x="450" y="656" text-anchor="middle" fill="#86efac" font-size="10" font-weight="bold">1x opus-verifier</text>

  <!-- Arrow to Step 4 -->
  <line x1="450" y1="665" x2="450" y2="695" stroke="#6366f1" stroke-width="2" marker-end="url(#arrowhead)"/>

  <!-- Step 4: Evaluate Score -->
  <rect x="300" y="700" width="300" height="60" rx="8" fill="#1e293b" stroke="#6366f1" stroke-width="2"/>
  <text x="450" y="725" text-anchor="middle" fill="#6366f1" font-size="12" font-weight="bold">STEP 4: Evaluate</text>
  <text x="450" y="745" text-anchor="middle" fill="white" font-size="14">Calculate consensus score</text>

  <!-- Score Decision Diamond -->
  <polygon points="450,780 540,830 450,880 360,830" fill="#1e293b" stroke="#f59e0b" stroke-width="2"/>
  <text x="450" y="825" text-anchor="middle" fill="#f59e0b" font-size="11" font-weight="bold">Score</text>
  <text x="450" y="840" text-anchor="middle" fill="#f59e0b" font-size="11" font-weight="bold">&lt; 10%?</text>

  <!-- No branch - Loop back -->
  <line x1="360" y1="830" x2="100" y2="830" stroke="#ef4444" stroke-width="2"/>
  <line x1="100" y1="830" x2="100" y2="180" stroke="#ef4444" stroke-width="2"/>
  <line x1="100" y1="180" x2="295" y2="180" stroke="#ef4444" stroke-width="2" marker-end="url(#arrowhead-red)"/>
  <text x="220" y="820" fill="#ef4444" font-size="11">No (need harder questions)</text>

  <!-- Loop indicator -->
  <rect x="60" y="500" width="30" height="30" rx="15" fill="#ef4444"/>
  <text x="75" y="520" text-anchor="middle" fill="white" font-size="16" font-weight="bold">&#8734;</text>

  <!-- Yes branch - to Commit -->
  <line x1="540" y1="830" x2="700" y2="830" stroke="#22c55e" stroke-width="2"/>
  <text x="610" y="820" fill="#22c55e" font-size="11">Yes</text>

  <!-- Step 5: Commit -->
  <rect x="600" y="805" width="200" height="50" rx="8" fill="#1e293b" stroke="#22c55e" stroke-width="2"/>
  <text x="700" y="825" text-anchor="middle" fill="#22c55e" font-size="12" font-weight="bold">STEP 5: Commit</text>
  <text x="700" y="843" text-anchor="middle" fill="white" font-size="12">Push to GitHub</text>

  <!-- Arrow to Success -->
  <line x1="700" y1="855" x2="700" y2="895" stroke="#22c55e" stroke-width="2" marker-end="url(#arrowhead-green)"/>

  <!-- Success -->
  <rect x="550" y="900" width="300" height="70" rx="8" fill="#166534" stroke="#22c55e" stroke-width="2"/>
  <text x="700" y="925" text-anchor="middle" fill="white" font-size="14" font-weight="bold">SUCCESS!</text>
  <text x="700" y="947" text-anchor="middle" fill="#bbf7d0" font-size="12">Found a question that breaks LLMs</text>
  <text x="700" y="963" text-anchor="middle" fill="#bbf7d0" font-size="11">research_status: complete</text>

  <!-- Legend -->
  <rect x="50" y="890" width="240" height="150" rx="8" fill="#1e293b" stroke="#475569" stroke-width="1"/>
  <text x="170" y="912" text-anchor="middle" fill="#94a3b8" font-size="11" font-weight="bold">AGENTS &amp; TOOLS</text>

  <!-- Agent legend items -->
  <rect x="65" y="922" width="90" height="16" rx="3" fill="#8b5cf6" opacity="0.4"/>
  <text x="115" y="934" fill="#c4b5fd" font-size="9">opus-researcher</text>
  <text x="220" y="934" fill="#94a3b8" font-size="9">Deep research</text>

  <rect x="65" y="944" width="90" height="16" rx="3" fill="#3b82f6" opacity="0.4"/>
  <text x="115" y="956" fill="#93c5fd" font-size="9">opus-answer</text>
  <text x="220" y="956" fill="#94a3b8" font-size="9">Simple LLM</text>

  <rect x="65" y="966" width="90" height="16" rx="3" fill="#22c55e" opacity="0.4"/>
  <text x="115" y="978" fill="#86efac" font-size="9">opus-verifier</text>
  <text x="220" y="978" fill="#94a3b8" font-size="9">Synthesize</text>

  <!-- MCP legend item -->
  <rect x="65" y="988" width="90" height="16" rx="3" fill="url(#mcpGradient)" stroke="#f97316" stroke-width="0.5"/>
  <text x="115" y="1000" fill="#f97316" font-size="9">MCP Tools</text>
  <text x="220" y="1000" fill="#94a3b8" font-size="9">Web + Reddit</text>

  <!-- Infinity symbol -->
  <circle cx="80" cy="1025" r="8" fill="#ef4444"/>
  <text x="80" y="1029" text-anchor="middle" fill="white" font-size="10" font-weight="bold">&#8734;</text>
  <text x="170" y="1029" fill="#94a3b8" font-size="9">Infinite loop</text>

  <!-- State files callout -->
  <rect x="620" y="180" width="250" height="100" rx="8" fill="#1e293b" stroke="#475569" stroke-width="1" stroke-dasharray="4"/>
  <text x="745" y="200" text-anchor="middle" fill="#64748b" font-size="10" font-weight="bold">STATE FILES</text>
  <text x="745" y="220" text-anchor="middle" fill="#94a3b8" font-size="9">research-workflow-state.yaml</text>
  <text x="745" y="235" text-anchor="middle" fill="#64748b" font-size="8">workflow execution</text>
  <text x="745" y="255" text-anchor="middle" fill="#94a3b8" font-size="9">research-questions.yaml</text>
  <text x="745" y="270" text-anchor="middle" fill="#64748b" font-size="8">questions database</text>
</svg>
