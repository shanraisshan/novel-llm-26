<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1000 1100" font-family="'SF Pro Display', system-ui, -apple-system, sans-serif">
  <defs>
    <!-- Animated gradient for the infinite loop path -->
    <linearGradient id="loopGradient" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#ef4444">
        <animate attributeName="stop-color" values="#ef4444;#f97316;#fbbf24;#ef4444" dur="3s" repeatCount="indefinite"/>
      </stop>
      <stop offset="50%" style="stop-color:#f97316">
        <animate attributeName="stop-color" values="#f97316;#fbbf24;#ef4444;#f97316" dur="3s" repeatCount="indefinite"/>
      </stop>
      <stop offset="100%" style="stop-color:#fbbf24">
        <animate attributeName="stop-color" values="#fbbf24;#ef4444;#f97316;#fbbf24" dur="3s" repeatCount="indefinite"/>
      </stop>
    </linearGradient>

    <!-- Glow filter -->
    <filter id="glow" x="-50%" y="-50%" width="200%" height="200%">
      <feGaussianBlur stdDeviation="4" result="coloredBlur"/>
      <feMerge>
        <feMergeNode in="coloredBlur"/>
        <feMergeNode in="SourceGraphic"/>
      </feMerge>
    </filter>

    <filter id="strongGlow" x="-100%" y="-100%" width="300%" height="300%">
      <feGaussianBlur stdDeviation="8" result="coloredBlur"/>
      <feMerge>
        <feMergeNode in="coloredBlur"/>
        <feMergeNode in="SourceGraphic"/>
      </feMerge>
    </filter>

    <!-- Pulse animation filter -->
    <filter id="pulse" x="-50%" y="-50%" width="200%" height="200%">
      <feGaussianBlur stdDeviation="3" result="blur">
        <animate attributeName="stdDeviation" values="3;6;3" dur="2s" repeatCount="indefinite"/>
      </feGaussianBlur>
      <feMerge>
        <feMergeNode in="blur"/>
        <feMergeNode in="SourceGraphic"/>
      </feMerge>
    </filter>

    <!-- Arrow markers -->
    <marker id="arrow" markerWidth="12" markerHeight="8" refX="10" refY="4" orient="auto">
      <path d="M0,0 L12,4 L0,8 L3,4 Z" fill="#6366f1"/>
    </marker>
    <marker id="arrow-success" markerWidth="12" markerHeight="8" refX="10" refY="4" orient="auto">
      <path d="M0,0 L12,4 L0,8 L3,4 Z" fill="#22c55e"/>
    </marker>
    <marker id="arrow-loop" markerWidth="12" markerHeight="8" refX="10" refY="4" orient="auto">
      <path d="M0,0 L12,4 L0,8 L3,4 Z" fill="url(#loopGradient)"/>
    </marker>

    <!-- Background pattern -->
    <pattern id="grid" width="40" height="40" patternUnits="userSpaceOnUse">
      <path d="M 40 0 L 0 0 0 40" fill="none" stroke="#1e293b" stroke-width="0.5"/>
    </pattern>

    <!-- Gradient backgrounds -->
    <linearGradient id="bgGradient" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#0f172a"/>
      <stop offset="50%" style="stop-color:#1a1a2e"/>
      <stop offset="100%" style="stop-color:#0f172a"/>
    </linearGradient>

    <linearGradient id="mcpGradient" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#f97316;stop-opacity:0.4"/>
      <stop offset="100%" style="stop-color:#8b5cf6;stop-opacity:0.4"/>
    </linearGradient>

    <radialGradient id="infinityGlow" cx="50%" cy="50%" r="50%">
      <stop offset="0%" style="stop-color:#ef4444;stop-opacity:0.8"/>
      <stop offset="100%" style="stop-color:#ef4444;stop-opacity:0"/>
    </radialGradient>
  </defs>

  <!-- Background layers -->
  <rect width="1000" height="1100" fill="url(#bgGradient)"/>
  <rect width="1000" height="1100" fill="url(#grid)" opacity="0.3"/>

  <!-- Decorative circles in background -->
  <circle cx="100" cy="200" r="150" fill="#6366f1" opacity="0.03"/>
  <circle cx="900" cy="800" r="200" fill="#22c55e" opacity="0.03"/>
  <circle cx="500" cy="550" r="300" fill="#8b5cf6" opacity="0.02"/>

  <!-- Title section -->
  <text x="500" y="55" text-anchor="middle" fill="white" font-size="32" font-weight="700" letter-spacing="-0.5">
    Novel LLM Research Workflow
  </text>
  <text x="500" y="85" text-anchor="middle" fill="#94a3b8" font-size="15" font-weight="300">
    Infinite loop until consensus &lt; 10% ‚Ä¢ MCP-Enhanced Research
  </text>

  <!-- Infinite Loop Panel on the left -->
  <g transform="translate(50, 340)">
    <!-- Panel background -->
    <rect x="0" y="0" width="140" height="280" rx="12" fill="#1e293b" stroke="#ef4444" stroke-width="2" opacity="0.9"/>
    <rect x="0" y="0" width="140" height="35" rx="12" fill="#ef4444" opacity="0.2"/>

    <!-- Title with infinity symbol -->
    <text x="70" y="15" text-anchor="middle" fill="url(#loopGradient)" font-size="20" font-weight="900" filter="url(#glow)">‚àû</text>
    <text x="70" y="30" text-anchor="middle" fill="#fca5a5" font-size="9" font-weight="600">INFINITE LOOP</text>

    <!-- Score >= 10% section -->
    <rect x="15" y="50" width="110" height="45" rx="6" fill="#f59e0b" opacity="0.15" stroke="#f59e0b" stroke-width="1"/>
    <text x="70" y="68" text-anchor="middle" fill="#fbbf24" font-size="10" font-weight="700">Score ‚â• 10%</text>
    <text x="70" y="82" text-anchor="middle" fill="#94a3b8" font-size="8">LLMs agreed</text>

    <!-- Arrow down -->
    <path d="M70,95 L70,110" stroke="#f59e0b" stroke-width="2" marker-end="url(#arrow-loop)"/>

    <!-- Loop back box -->
    <rect x="15" y="115" width="110" height="55" rx="6" fill="#ef4444" opacity="0.15" stroke="#ef4444" stroke-width="1"/>
    <text x="70" y="135" text-anchor="middle" fill="#fca5a5" font-size="9" font-weight="600">üîÑ TRY AGAIN</text>
    <text x="70" y="150" text-anchor="middle" fill="#94a3b8" font-size="8">Generate harder</text>
    <text x="70" y="162" text-anchor="middle" fill="#94a3b8" font-size="8">question</text>

    <!-- Curved loop arrow back up -->
    <path d="M125,140 Q145,140 145,75 Q145,50 125,50"
          stroke="url(#loopGradient)" stroke-width="2" fill="none"
          stroke-dasharray="4,2" marker-end="url(#arrow-loop)">
      <animate attributeName="stroke-dashoffset" values="0;-12" dur="0.8s" repeatCount="indefinite"/>
    </path>

    <!-- Divider -->
    <line x1="20" y1="185" x2="120" y2="185" stroke="#475569" stroke-width="1" stroke-dasharray="3,3"/>

    <!-- Score < 10% section -->
    <rect x="15" y="195" width="110" height="45" rx="6" fill="#22c55e" opacity="0.15" stroke="#22c55e" stroke-width="1"/>
    <text x="70" y="213" text-anchor="middle" fill="#22c55e" font-size="10" font-weight="700">Score &lt; 10%</text>
    <text x="70" y="227" text-anchor="middle" fill="#94a3b8" font-size="8">LLMs disagreed!</text>

    <!-- Arrow to success -->
    <path d="M70,240 L70,250" stroke="#22c55e" stroke-width="2" marker-end="url(#arrow-success)"/>

    <!-- Exit/Success indicator -->
    <rect x="25" y="255" width="90" height="20" rx="10" fill="#166534"/>
    <text x="70" y="269" text-anchor="middle" fill="#bbf7d0" font-size="9" font-weight="600">üéâ EXIT</text>
  </g>

  <!-- Start button -->
  <g filter="url(#glow)">
    <rect x="380" y="115" width="240" height="55" rx="27" fill="#22c55e"/>
    <text x="500" y="150" text-anchor="middle" fill="white" font-size="16" font-weight="600">/execute-workflow</text>
  </g>

  <!-- Flow path from start -->
  <path d="M500,170 L500,210" stroke="#6366f1" stroke-width="3" fill="none" marker-end="url(#arrow)"/>

  <!-- STEP 1: Check State -->
  <g>
    <rect x="320" y="220" width="360" height="75" rx="12" fill="#1e293b" stroke="#6366f1" stroke-width="2"/>
    <rect x="320" y="220" width="360" height="30" rx="12" fill="#6366f1" opacity="0.2"/>
    <text x="340" y="243" fill="#818cf8" font-size="11" font-weight="700">STEP 1</text>
    <text x="500" y="243" text-anchor="middle" fill="white" font-size="14" font-weight="600">Check Workflow State</text>
    <text x="500" y="275" text-anchor="middle" fill="#94a3b8" font-size="13">Read workflow-state.yaml + questions database</text>
  </g>

  <!-- Decision: Pending question? -->
  <g transform="translate(500, 370)">
    <polygon points="0,-55 90,0 0,55 -90,0" fill="#1e293b" stroke="#f59e0b" stroke-width="2"/>
    <text x="0" y="-10" text-anchor="middle" fill="#fbbf24" font-size="13" font-weight="600">Pending</text>
    <text x="0" y="10" text-anchor="middle" fill="#fbbf24" font-size="13" font-weight="600">Question?</text>
  </g>

  <!-- Arrow from Step 1 to Decision -->
  <path d="M500,295 L500,315" stroke="#6366f1" stroke-width="3" fill="none" marker-end="url(#arrow)"/>

  <!-- NO branch - curved path to Generate -->
  <path d="M410,370 Q300,370 300,440" stroke="url(#loopGradient)" stroke-width="3" fill="none" marker-end="url(#arrow-loop)" stroke-dasharray="8,4">
    <animate attributeName="stroke-dashoffset" values="0;-24" dur="1s" repeatCount="indefinite"/>
  </path>
  <text x="340" y="395" fill="#fbbf24" font-size="12" font-weight="500">NO</text>

  <!-- YES branch - to Verify -->
  <path d="M590,370 Q750,370 750,540" stroke="#22c55e" stroke-width="3" fill="none" marker-end="url(#arrow-success)"/>
  <text x="670" y="395" fill="#22c55e" font-size="12" font-weight="500">YES</text>

  <!-- STEP 2: Generate Question -->
  <g>
    <rect x="170" y="450" width="360" height="160" rx="12" fill="#1e293b" stroke="#8b5cf6" stroke-width="2"/>
    <rect x="170" y="450" width="360" height="30" rx="12" fill="#8b5cf6" opacity="0.2"/>
    <text x="190" y="473" fill="#a78bfa" font-size="11" font-weight="700">STEP 2</text>
    <text x="350" y="473" text-anchor="middle" fill="white" font-size="14" font-weight="600">Generate Novel Question</text>

    <text x="350" y="505" text-anchor="middle" fill="#94a3b8" font-size="12">Deep research + creative generation</text>

    <!-- Agent badge -->
    <rect x="260" y="515" width="180" height="28" rx="6" fill="#8b5cf6" opacity="0.3"/>
    <text x="350" y="535" text-anchor="middle" fill="#c4b5fd" font-size="12" font-weight="600">üî¨ 1√ó opus-researcher</text>

    <!-- MCP Tools section -->
    <rect x="195" y="555" width="310" height="45" rx="8" fill="url(#mcpGradient)" stroke="#f97316" stroke-width="1.5"/>
    <text x="350" y="573" text-anchor="middle" fill="#f97316" font-size="11" font-weight="700">‚ö° MCP TOOLS</text>
    <text x="350" y="590" text-anchor="middle" fill="#fdba74" font-size="11">Tavily Web Search ‚Ä¢ Reddit API ‚Ä¢ Real-time Data</text>
  </g>

  <!-- Arrow from Generate to Verify -->
  <path d="M530,530 Q590,530 590,545" stroke="#6366f1" stroke-width="3" fill="none" marker-end="url(#arrow)"/>

  <!-- STEP 3: Verify Question -->
  <g>
    <rect x="570" y="550" width="360" height="170" rx="12" fill="#1e293b" stroke="#3b82f6" stroke-width="2"/>
    <rect x="570" y="550" width="360" height="30" rx="12" fill="#3b82f6" opacity="0.2"/>
    <text x="590" y="573" fill="#60a5fa" font-size="11" font-weight="700">STEP 3</text>
    <text x="750" y="573" text-anchor="middle" fill="white" font-size="14" font-weight="600">Verify Question Novelty</text>

    <text x="750" y="605" text-anchor="middle" fill="#94a3b8" font-size="12">Can standard LLMs answer this?</text>

    <!-- Parallel answerers -->
    <rect x="610" y="620" width="280" height="32" rx="6" fill="#3b82f6" opacity="0.3"/>
    <text x="750" y="642" text-anchor="middle" fill="#93c5fd" font-size="12" font-weight="600">ü§ñ 5√ó opus-answer (parallel)</text>

    <!-- Verifier -->
    <rect x="660" y="662" width="180" height="28" rx="6" fill="#22c55e" opacity="0.3"/>
    <text x="750" y="682" text-anchor="middle" fill="#86efac" font-size="12" font-weight="600">‚úì 1√ó opus-verifier</text>

    <text x="750" y="708" text-anchor="middle" fill="#64748b" font-size="11">Synthesize responses ‚Üí consensus score</text>
  </g>

  <!-- Arrow to Evaluate -->
  <path d="M750,720 L750,760" stroke="#6366f1" stroke-width="3" fill="none" marker-end="url(#arrow)"/>

  <!-- STEP 4: Evaluate -->
  <g>
    <rect x="570" y="770" width="360" height="70" rx="12" fill="#1e293b" stroke="#6366f1" stroke-width="2"/>
    <rect x="570" y="770" width="360" height="28" rx="12" fill="#6366f1" opacity="0.2"/>
    <text x="590" y="791" fill="#818cf8" font-size="11" font-weight="700">STEP 4</text>
    <text x="750" y="791" text-anchor="middle" fill="white" font-size="14" font-weight="600">Evaluate Consensus Score</text>
    <text x="750" y="820" text-anchor="middle" fill="#94a3b8" font-size="13">Calculate % agreement among answerers</text>
  </g>

  <!-- Final Decision Diamond -->
  <g transform="translate(500, 920)">
    <polygon points="0,-55 90,0 0,55 -90,0" fill="#1e293b" stroke="#f59e0b" stroke-width="2"/>
    <text x="0" y="-10" text-anchor="middle" fill="#fbbf24" font-size="13" font-weight="600">Score</text>
    <text x="0" y="10" text-anchor="middle" fill="#fbbf24" font-size="13" font-weight="600">&lt; 10%?</text>
  </g>

  <!-- Arrow from Evaluate to Decision -->
  <path d="M750,840 L750,870 Q750,900 620,900 L590,920" stroke="#6366f1" stroke-width="3" fill="none" marker-end="url(#arrow)"/>

  <!-- THE INFINITE LOOP - NO branch with animated dashes -->
  <path d="M410,920 L180,920 L180,295 Q180,220 320,220"
        stroke="url(#loopGradient)" stroke-width="4" fill="none"
        marker-end="url(#arrow-loop)"
        stroke-dasharray="12,6"
        filter="url(#glow)">
    <animate attributeName="stroke-dashoffset" values="0;-36" dur="1.5s" repeatCount="indefinite"/>
  </path>

  <!-- Loop label -->
  <text x="295" y="905" fill="#fca5a5" font-size="11" font-weight="500">NO ‚Äî loop back</text>

  <!-- YES branch - to Commit -->
  <path d="M590,920 Q680,920 750,950" stroke="#22c55e" stroke-width="3" fill="none" marker-end="url(#arrow-success)"/>
  <text x="640" y="905" fill="#22c55e" font-size="12" font-weight="500">YES</text>

  <!-- STEP 5: Commit -->
  <g filter="url(#glow)">
    <rect x="660" y="955" width="200" height="55" rx="10" fill="#1e293b" stroke="#22c55e" stroke-width="2"/>
    <text x="760" y="978" text-anchor="middle" fill="#22c55e" font-size="11" font-weight="700">STEP 5</text>
    <text x="760" y="998" text-anchor="middle" fill="white" font-size="13" font-weight="600">Commit to GitHub</text>
  </g>

  <!-- Arrow to Success -->
  <path d="M760,1010 L760,1030" stroke="#22c55e" stroke-width="3" fill="none" marker-end="url(#arrow-success)"/>

  <!-- Success Box -->
  <g filter="url(#glow)">
    <rect x="600" y="1035" width="320" height="55" rx="12" fill="#166534" stroke="#22c55e" stroke-width="2"/>
    <text x="760" y="1060" text-anchor="middle" fill="white" font-size="16" font-weight="700">üéâ SUCCESS!</text>
    <text x="760" y="1080" text-anchor="middle" fill="#bbf7d0" font-size="12">Found a question that breaks LLMs!</text>
  </g>

  <!-- State Files Panel -->
  <g>
    <rect x="700" y="220" width="260" height="105" rx="10" fill="#1e293b" stroke="#475569" stroke-width="1" stroke-dasharray="6,3"/>
    <text x="830" y="245" text-anchor="middle" fill="#64748b" font-size="11" font-weight="700">üìÅ STATE FILES</text>

    <text x="720" y="270" fill="#94a3b8" font-size="10">research-workflow-state.yaml</text>
    <text x="720" y="285" fill="#64748b" font-size="9">‚Üí workflow execution state</text>

    <text x="720" y="305" fill="#94a3b8" font-size="10">research-questions.yaml</text>
    <text x="720" y="320" fill="#64748b" font-size="9">‚Üí questions database</text>
  </g>

  <!-- Legend Panel -->
  <g>
    <rect x="50" y="910" width="280" height="170" rx="12" fill="#1e293b" stroke="#475569" stroke-width="1"/>
    <text x="190" y="938" text-anchor="middle" fill="white" font-size="13" font-weight="600">Agent Types</text>

    <!-- opus-researcher -->
    <rect x="70" y="955" width="120" height="22" rx="5" fill="#8b5cf6" opacity="0.4"/>
    <text x="130" y="971" text-anchor="middle" fill="#c4b5fd" font-size="10" font-weight="500">opus-researcher</text>
    <text x="260" y="971" text-anchor="middle" fill="#94a3b8" font-size="10">Deep analysis</text>

    <!-- opus-answer -->
    <rect x="70" y="985" width="120" height="22" rx="5" fill="#3b82f6" opacity="0.4"/>
    <text x="130" y="1001" text-anchor="middle" fill="#93c5fd" font-size="10" font-weight="500">opus-answer</text>
    <text x="260" y="1001" text-anchor="middle" fill="#94a3b8" font-size="10">Standard LLM</text>

    <!-- opus-verifier -->
    <rect x="70" y="1015" width="120" height="22" rx="5" fill="#22c55e" opacity="0.4"/>
    <text x="130" y="1031" text-anchor="middle" fill="#86efac" font-size="10" font-weight="500">opus-verifier</text>
    <text x="260" y="1031" text-anchor="middle" fill="#94a3b8" font-size="10">Synthesize</text>

    <!-- MCP Tools -->
    <rect x="70" y="1045" width="120" height="22" rx="5" fill="url(#mcpGradient)" stroke="#f97316" stroke-width="0.5"/>
    <text x="130" y="1061" text-anchor="middle" fill="#f97316" font-size="10" font-weight="500">MCP Tools</text>
    <text x="260" y="1061" text-anchor="middle" fill="#94a3b8" font-size="10">External APIs</text>
  </g>
</svg>